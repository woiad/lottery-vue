webpackJsonp([3],{"0yXI":function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpldj0iaHR0cDovL3d3dy53My5vcmcvMjAwMS94bWwtZXZlbnRzIiB2ZXJzaW9uPSIxLjEiIGJhc2VQcm9maWxlPSJmdWxsIiBoZWlnaHQ9IjYwcHgiIHdpZHRoPSI2MHB4Ij4KPHBhdGggc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIG9wYWNpdHk9IjAuNTAyIiBmaWxsPSJyZ2IoIDAsIDAsIDAgKSIgZD0iTTMwLDEgQzQ2LjAxNiwxIDU5LDEzLjk4NCA1OSwzMCBDNTksNDYuMDE2IDQ2LjAxNiw1OSAzMCw1OSBDMTMuOTg0LDU5IDEsNDYuMDE2IDEsMzAgQzEsMTMuOTg0IDEzLjk4NCwxIDMwLDEgWiAiIC8+CjxwYXRoIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBmaWxsPSJyZ2IoIDI1NSwgMjU1LCAyNTUgKSIgZD0iTTMwLDYwIEMxMy40MzEsNjAgMCw0Ni41NjkgMCwzMCBDMCwxMy40MzEgMTMuNDMxLDAgMzAsMCBDNDYuNTY5LDAgNjAsMTMuNDMxIDYwLDMwIEM2MCw0Ni41NjkgNDYuNTY5LDYwIDMwLDYwIFpNMzAsMyBDMTUuMDg4LDMgMywxNS4wODggMywzMCBDMyw0NC45MTIgMTUuMDg4LDU3IDMwLDU3IEM0NC45MTIsNTcgNTcsNDQuOTEyIDU3LDMwIEM1NywxNS4wODggNDQuOTEyLDMgMzAsMyBaICIgLz4KPHBhdGggc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIGZpbGw9InJnYiggMjU1LCAyNTUsIDI1NSApIiBkPSJNMzEuMDg4LDEwIEMzMS4zNywxMi4wMDEgMzEuNDEsMTQuNTI0IDMzLjUwNiwxNy4wNDcgQzM1LjExNywxOC45NjkgMzYuOTMxLDIwLjY5IDM4LjE4LDIyLjI1MiBDMzkuODMyLDI0LjI5NCA0MSwyNi44NTcgNDEsMjkuNDYgQzQxLDMzLjYyNCAzOC45ODYsMzcuNzQ3IDM3LjYxNSw0MC4wMyBDMzcuNjE1LDQwLjAzIDM2Ljk3MSw0MC4wMyAzNi45NzEsNDAuMDMgQzM3LjkzOCwzNy44NjggMzkuODcyLDM0LjMwNCAzOS43MSwzMC41MDEgQzM5LjYzLDI4LjM3OCAzOC44MjQsMjYuMDk2IDM3LjQ1NSwyNC40MTUgQzM1LjkyMywyMi40NTIgMzMuMzQ0LDIwLjg5MSAzMS4wODgsMjAuNzMxIEMzMS4wODgsMjAuNzMxIDMxLjA4OCw0My40MzMgMzEuMDg4LDQzLjQzMyBDMzEuMDg4LDQ1LjIzNSAzMCw0Ni44NzcgMjguNDI5LDQ4LjA3OCBDMjYuODk4LDQ5LjI3OSAyNC44ODMsNTAgMjMuMTEsNTAgQzIxLjk4Miw1MCAyMC45MzQsNDkuNjQgMjAuMjA5LDQ5LjAzOSBDMTkuNDQzLDQ4LjQzOCAxOSw0Ny41NTggMTksNDYuNTE3IEMxOSw0NC44NzUgMjAuMTI4LDQzLjIzMyAyMS42NTksNDIuMDMyIEMyMy4xOTEsNDAuNzkxIDI1LjEyNCwzOS45OSAyNi43MzYsMzkuOTkgQzI4LjE0NywzOS45OSAyOS4zNTUsNDAuMTkgMzAuMDgxLDQwLjg3MSBDMzAuMDgxLDQwLjg3MSAzMC4wODEsMTAgMzAuMDgxLDEwIEMzMC4wODEsMTAgMzEuMDg4LDEwIDMxLjA4OCwxMCBaICIgLz4KPC9zdmc+"},AVw7:function(t,e){},f0RF:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),n=i.n(s),a=i("ZoQJ");function r(t,e){return parseInt(Math.random()*(e-t)-1)+t}function o(t,e){return t+Math.random()*(e-t)}function l(t){return t+"s"}var c=function(){var t="../static/img/color"+r(1,10)+".png",e=r(0,document.body.clientWidth)+"px",i=Math.random()<.5?"leftRotation":"rightRotation",s=l(o(5,11)),n=l(o(4,8)),a=l(o(0,5)),c=document.createElement("div"),h=document.createElement("img");return h.src=t,c.style.top="-100px",c.style.left=e,c.style.webkitAnimationName="fade,drop",h.style.webkitAnimationName=i,c.style.webkitAnimationDuration=s+","+s,c.style.webkitAnimationDelay=a+","+a,h.style.webkitAnimationDuration=n,c.appendChild(h),c},h={name:"lotteryDevice",data:function(){return{boxShow:!1,cylic:"",luckyNum:[],drawerShow:!1,prizeDesc:"请选择奖项开始抽奖",lotteryTipShow:!1,prizeButSrc:"../static/img/prize_start.png",luckyer:[],prizeLevel:[{title:"特等奖",level:1},{title:"一等奖",level:2},{title:"二等奖",level:3},{title:"三等奖",level:4},{title:"随机一",level:5},{title:"随机二",level:6}],level:1,listImg:[],camera:"",scene:"",renderer:"",controls:"",objects:[],targets:{table:[],sphere:[],helix:[],grid:[]},targetsdh:{table:[],sphere:[],helix:[],grid:[]},imgNum:0}},mounted:function(){var t=this;this.$post("/pyapi/console",{key:"ps_show",content:"listimg"}).then(function(e){t.listImg=e,t.init(),t.animate()}).catch(function(t){console.log(t)})},methods:{init:function(){for(var t=[],e=0;e<this.listImg.length;e++){var i={};i.image="http://113.105.246.230:5110/"+this.listImg[e].picdir,i.name=this.listImg[e].username,i.pos_x=e%20+1,i.pos_y=Math.floor(e/20)+1,t.push(i)}for(var s=[],n=0;n<t.length;n++)s.push(t[n]);this.camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,4e3),this.camera.position.z=3e3,this.scene=new THREE.Scene;for(var r=0;r<s.length;r++){var o=document.createElement("div");o.className="element";var l=document.createElement("img");l.className="avatar",l.src=s[r].image,o.appendChild(l);var c=new THREE.CSS3DObject(o);c.position.x=4e3*Math.random()-2e3,c.position.y=4e3*Math.random()-2e3,c.position.z=4e3*Math.random()-2e3,this.scene.add(c),this.objects.push(c);var h=new THREE.Object3D;h.position.x=140*s[r].pos_x-1330,h.position.y=-180*s[r].pos_y+990,this.targets.table.push(h)}for(var u=new THREE.Vector3,M=0,d=this.objects.length;M<d;M++){var m=Math.acos(2*M/d-1),p=Math.sqrt(d*Math.PI)*m,g=new THREE.Object3D;g.position.x=800*Math.cos(p)*Math.sin(m),g.position.y=800*Math.sin(p)*Math.sin(m),g.position.z=800*Math.cos(m),u.copy(g.position).multiplyScalar(2),g.lookAt(u),this.targets.sphere.push(g);var w=new THREE.Object3D;w.position.x=9e3*Math.cos(p)*Math.sin(m),w.position.y=9e3*Math.sin(p)*Math.sin(m),w.position.z=9e3*Math.cos(m),u.copy(w.position).multiplyScalar(2),w.lookAt(u),this.targetsdh.sphere.push(w)}for(var y=0;y<this.objects.length;y++){var D=new THREE.Object3D;D.position.x=y%5*400-800,D.position.y=-Math.floor(y/5)%5*300+500,D.position.z=200*Math.floor(y/25)-800,this.targets.grid.push(D)}this.renderer=new THREE.CSS3DRenderer,this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.domElement.style.position="absolute",a.a.getId("state").appendChild(this.renderer.domElement),this.controls=new THREE.TrackballControls(this.camera),this.controls.rotateSpeed=.5,this.controls.minDistance=500,this.controls.maxDistance=6e3,this.controls.addEventListener("change",this.render),this.transform(this.targets.grid,3e3),window.addEventListener("resize",this.onWindowResize,!1)},transform:function(t,e){TWEEN.removeAll();for(var i=0;i<this.objects.length;i++){var s=this.objects[i],n=t[i];new TWEEN.Tween(s.position).to({x:n.position.x,y:n.position.y,z:n.position.z},Math.random()*e+e).start(),new TWEEN.Tween(s.rotation).to({x:n.rotation.x,y:n.rotation.y,z:n.rotation.z},Math.random()*e+e).start()}new TWEEN.Tween(this).to({},2*e).onUpdate(this.render).start()},onWindowResize:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight),this.render()},render:function(){this.renderer.render(this.scene,this.camera)},animate:function(){this.boxShow?(this.scene.rotation.x+=.008,this.scene.rotation.y+=.008):(this.scene.rotation.x+=0,this.scene.rotation.y+=.008),requestAnimationFrame(this.animate),TWEEN.update(),this.controls.update(),this.render()},lotteryClick:function(){var t=this;if(this.setImgNum(),"请选择奖项开始抽奖"===this.prizeDesc)return alert("请选择奖项！"),!0;var e=a.a.getId("music");if("../static/img/prize_start.png"===this.prizeButSrc){var i=this.setLocalStorage();if(i)return alert(i),!0;this.setLuckyImgPath(),this.prizeButSrc="../static/img/prize_stop.png",this.transform(this.targets.sphere,1e3),setTimeout(function(){t.boxShow=!0},800),e.src="../static/music/play.wav",e.play(),a.a.getId("audioBtn").classList.add("rotating")}else{this.luck(),this.prizeButSrc="../static/img/prize_start.png",clearInterval(this.cylic),e.src="../static/music/lucky.wav",e.play(),this.transform(this.targets.grid,1e3);for(var s=0;s<50;s++)a.a.getId("leafContainer").appendChild(c());setTimeout(function(){t.lotteryTipShow=!0,t.luckPeople()},1e3)}},setImgNum:function(){var t=this;this.$post("/pyapi/console",{key:"prize_show"}).then(function(e){if(403===e[1])alert(e[0]+e[1]);else for(var i=function(i){t.level===e[i].level&&(t.imgNum=e[i].num,t.$nextTick(function(){a.a.getId("box").style.marginLeft="-"+Math.floor((120*e[i].num+15*e[i].num)/2)+"px"}))},s=0;s<e.length;s++)i(s)}).catch(function(t){alert("err:"+t)})},setLuckyImgPath:function(){var t=this;this.cylic=setInterval(function(){t.luckyNum=[];for(var e=0;e<t.imgNum;e++){var i={};i.src="http://113.105.246.230:5110/"+t.listImg[t.setRandom()].picdir,t.luckyNum.push(i)}},150)},setRandom:function(){return Math.floor(Math.random()*this.listImg.length)},choseLottery:function(t,e){this.level=e,this.prizeDesc=t,this.drawerShow=!1},luck:function(){var t=this;this.$post("/pyapi/console",{key:"luck",content:this.level}).then(function(e){if(403===e[1])return alert("error:"+e[2]),!0;for(var i=0;i<e.length;i++)t.luckyNum[i].src="http://113.105.246.230:5110/"+e[i].picdir;t.luckyer=e}).catch(function(t){console.log(t)})},luckPeople:function(){for(var t=this,e=0,i=function(i){var s=t;setTimeout(function(){var t=document.createElement("div");t.className="list",t.style.opacity=0,t.style.animation="move 2s ease-in-out",t.style.animationDelay=.5*i+"s";var n=document.createElement("img");n.className="list_img",n.src="http://113.105.246.230:5110/"+s.luckyer[i].picdir,t.appendChild(n);var r=document.createElement("p");r.className="list_name",r.innerHTML="姓名："+s.luckyer[i].name;var o=document.createElement("p");o.className="list_name",o.innerHTML="工号："+s.luckyer[i].jobnum;var l=document.createElement("p");l.className="list_name",l.innerHTML="奖品："+s.luckyer[i].pz,t.appendChild(r),t.appendChild(o),t.appendChild(l),s.luckyer.length>20&&(t.style.width="100px",t.style.height="100px",n.style.width="45px",n.style.height="45px",n.style.marginTop="15px"),t.addEventListener("animationend",function(){e++,t.style.opacity=1,e===s.luckyer.length&&setTimeout(function(){alert("本次抽奖完毕，请返回进行下等级抽奖")},500)},!1),a.a.getId("tip_list").appendChild(t)},500)},s=0;s<this.luckyer.length;s++)i(s)},back:function(){this.boxShow=!1,this.lotteryTipShow=!1,this.luckyer=[],this.luckyNum=[],a.a.getId("audioBtn").classList.remove("rotating"),a.a.getId("music").pause();for(var t=document.getElementsByClassName("list");t.length>0;)t[0].remove()},setLocalStorage:function(){var t=[];if(localStorage.getItem("lotteryLevel")){t=JSON.parse(localStorage.getItem("lotteryLevel"));for(var e=0;e<t.length;e++)if(this.level===t[e])return"请选择下一奖项抽奖！";if(t[t.length-1]!==this.level-1)return"请按照奖项顺序抽奖!";t.push(this.level),localStorage.setItem("lotteryLevel",n()(t))}else{if(1!==this.level)return"请按照奖项顺序抽奖!";t.push(this.level),localStorage.setItem("lotteryLevel",n()(t))}}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lottery-device-wrapper"},[i("div",{staticClass:"title"}),t._v(" "),i("div",{staticClass:"side-bar"},[i("div",{staticClass:"nav",on:{click:function(e){t.drawerShow=!0}}}),t._v(" "),i("div",{staticClass:"text"},[t._v("\n      "+t._s(t.prizeDesc)+"\n    ")])]),t._v(" "),t._m(0),t._v(" "),i("transition",{attrs:{name:"slide"}},[t.drawerShow?i("div",{staticClass:"drawer-wrapper"},[i("div",{staticClass:"close",on:{click:function(e){t.drawerShow=!1}}}),t._v(" "),i("div",{staticClass:"draw-container"},[i("ul",t._l(t.prizeLevel,function(e,s){return i("li",{key:s,on:{click:function(i){t.choseLottery(e.title,e.level)}}},[t._v(t._s(e.title))])}),0)])]):t._e()]),t._v(" "),i("div",{staticClass:"state",attrs:{id:"state"}}),t._v(" "),i("div",{staticClass:"lottery",on:{click:t.lotteryClick}},[i("img",{attrs:{src:t.prizeButSrc,id:"prize_img"}})]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.lotteryTipShow,expression:"lotteryTipShow"}],staticClass:"tip_list",attrs:{id:"tip_list"}},[i("div",{staticClass:"tip_title"},[t._v("\n        "+t._s(t.prizeDesc)+"中奖名单\n      ")]),t._v(" "),i("div",{attrs:{id:"leafContainer"}}),t._v(" "),i("div",{staticClass:"btn"},[i("button",{staticClass:"back",on:{click:t.back}},[t._v("返回抽奖")])])])]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.boxShow,expression:"boxShow"}],staticClass:"box-wrapper"},[i("div",{staticClass:"box",attrs:{id:"box"}},t._l(t.luckyNum,function(t,e){return i("li",{key:e},[i("img",{attrs:{src:t.src}})])}),0)])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"audio-wrapper"},[e("div",{staticClass:"audio-btn",attrs:{id:"audioBtn"}},[e("img",{attrs:{src:i("0yXI")}})]),this._v(" "),e("audio",{attrs:{src:"../static/music/play.wav",id:"music"}})])}]};var M=i("VU/8")(h,u,!1,function(t){i("AVw7")},null,null);e.default=M.exports}});
//# sourceMappingURL=3.90f029515eb253d7ea79.js.map